# 要件定義書：NBA API統合

**優先順位**: 高  
**作成日**: 2025-01-23  
**ステータス**: 実装中

## 概要

実際のNBA試合データを取得し、試合スレッドを自動生成・管理する機能

## 目的

- 実際のNBA試合情報に基づいたスレッドの表示
- 終了した試合のスレッドを自動削除
- リアルタイムの試合情報の表示

## API選定

### 推奨API

1. **Ball Don't Lie API**（非公式、無料）
   - URL: https://www.balldontlie.io/
   - 無料で利用可能
   - 試合スケジュール、スコア、統計情報を取得可能

2. **RapidAPI - NBA API**（一部無料）
   - URL: https://rapidapi.com/
   - 無料プランあり（制限あり）
   - より詳細なデータを取得可能

3. **API-Sports - NBA**（無料プランあり）
   - URL: https://api-sports.io/
   - 無料プラン：500リクエスト/日
   - リアルタイムデータ対応

## 実装内容

### 1. 環境変数の設定

```env
NBA_API_KEY=your_api_key_here
NBA_API_BASE_URL=https://api.balldontlie.io/v1
```

### 2. 試合データ取得スクリプト

- 今日の試合を取得
- 試合スケジュールを取得
- 試合スコアを更新

### 3. スレッド自動生成

- 試合が開始されたらスレッドを自動生成
- 試合情報をスレッドに紐付け

### 4. 終了した試合のスレッド削除

- 試合が終了したら、関連スレッドを削除
- または、アーカイブ状態にする

### 5. 定期実行

- Vercel Cron Jobsを使用
- または、サーバーレス関数で定期実行

## データフロー

1. APIから試合データを取得
2. Firestoreの`matches`コレクションを更新
3. 新しい試合があれば、スレッドを自動生成
4. 終了した試合のスレッドを削除

## 注意事項

- APIの利用規約を遵守
- レート制限に注意
- エラーハンドリングを適切に実装



