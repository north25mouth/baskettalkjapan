# 予算アラート・使用量制限の設定ガイド

無料枠を超えた場合の予想外の課金を防ぐための設定手順

## ⚠️ 重要な注意

**無料枠を超えた場合、自動的に課金されます。**

以下の設定を行うことで：
- 予算に近づいた時点で通知を受け取れる（予算アラート）
- 予算を超えた時点で自動的にサービスを停止できる（使用量制限）

## 📋 設定手順

### ステップ1: Google Cloud Consoleにアクセス

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. プロジェクト「baskettalkjapan」を選択
3. 左メニューから「請求」を選択

### ステップ2: 予算を作成

1. 「予算とアラート」を選択
2. 「予算を作成」をクリック

### ステップ3: 予算の基本設定

1. **予算名**: 「Firestore 予算」など、わかりやすい名前を入力
2. **予算額**: 
   - 推奨: **$0.5/月** または **$1/月**
   - 無料枠内で使用する場合は、$0.5/月で十分です
3. **予算期間**: 「月次」を選択
4. **予算の範囲**: 「すべてのプロジェクト」または「baskettalkjapan」を選択

### ステップ4: アラートの設定（重要）

**予算に近づいた時点で通知を受け取る設定：**

1. 「アラートの設定」セクションで以下を設定：
   - **50%**: 予算の50%に達した時点で通知
   - **90%**: 予算の90%に達した時点で通知
   - **100%**: 予算の100%に達した時点で通知

2. **通知先のメールアドレス**を入力（複数可）

3. 「アラートを追加」をクリック

### ステップ5: 使用量制限の設定（最も安全）

**予算を超えた時点で自動的にサービスを停止する設定：**

⚠️ **この設定を有効にすると、予算を超えた時点でサービスが自動的に停止します。**

1. 「予算を超えたらすべてのプロジェクトを無効にする」のチェックボックスを**有効化**
2. これにより、予算を超えた時点で：
   - サービスが自動的に停止
   - それ以上の課金が発生しない

### ステップ6: 予算の作成

1. すべての設定を確認
2. 「作成」をクリック
3. 予算が作成されました

## 🔔 通知の確認

### メール通知

予算に近づいた時点で、設定したメールアドレスに通知が届きます：

- **50%**: 「予算の50%に達しました」という通知
- **90%**: 「予算の90%に達しました」という通知
- **100%**: 「予算の100%に達しました」という通知

### Google Cloud Consoleでの確認

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 「請求」>「予算とアラート」を選択
3. 作成した予算を選択
4. 「アラート履歴」で通知履歴を確認

## 🛑 サービスが停止した場合

### 使用量制限を設定していた場合

予算を超えた時点でサービスが自動的に停止します。

### サービスを再開する方法

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 「請求」>「予算とアラート」を選択
3. 作成した予算を選択
4. 「予算を超えたらすべてのプロジェクトを無効にする」を**無効化**
5. または、予算額を増やす

### サービスが停止した理由を確認

1. Firebase Consoleで使用量を確認
2. どのサービスが予算を超えたか確認
3. 必要に応じて、不要なデータを削除

## 💡 推奨設定

### 最小限の設定（通知のみ）

- **予算額**: $0.5/月
- **アラート**: 50%、90%、100%
- **使用量制限**: 無効（通知のみ）

### 最も安全な設定（自動停止）

- **予算額**: $0.5/月
- **アラート**: 50%、90%、100%
- **使用量制限**: **有効**（予算を超えたら自動停止）

**推奨**: 使用量制限を有効にすることで、予想外の課金を完全に防げます。

## 📊 予算の調整

### 予算額を変更する場合

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 「請求」>「予算とアラート」を選択
3. 作成した予算を選択
4. 「編集」をクリック
5. 予算額を変更
6. 「保存」をクリック

### 予算を削除する場合

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 「請求」>「予算とアラート」を選択
3. 作成した予算を選択
4. 「削除」をクリック

## ❓ よくある質問

### Q: 予算を$0に設定できますか？

**A: いいえ。** 予算額は$0.01以上である必要があります。無料枠内で使用する場合は、$0.5/月程度を設定してください。

### Q: 使用量制限を設定すると、サービスが停止しますか？

**A: 予算を超えた場合のみ停止します。** 予算内であれば、サービスは正常に動作します。

### Q: サービスが停止したら、どうすればいいですか？

**A: 以下のいずれかの方法で再開できます：**
1. 予算額を増やす
2. 使用量制限を無効化（ただし、課金が継続する可能性があります）
3. 不要なデータを削除して使用量を減らす

### Q: 予算アラートと使用量制限の違いは？

**A:**
- **予算アラート**: 通知のみ（サービスは継続、課金も継続）
- **使用量制限**: 予算を超えた時点で自動停止（課金を完全に防げる）

## 📚 参考リンク

- [Google Cloud 予算とアラート](https://cloud.google.com/billing/docs/how-to/budgets)
- [Firebase 料金](https://firebase.google.com/pricing?hl=ja)

